import fs from "fs";
import { taskListGenerator } from "./packages";

const huskyConfig = (options) => {
  const filename = `${options.targetDirectory}/.huskyrc`;

  const husky = {
    hooks: {
      "pre-commit": "lint-staged",
    },
  };

  fs.writeFileSync(filename, JSON.stringify(husky, null, 2));
};

const eslintConfig = (options) => {
  const filename = `${options.targetDirectory}/.eslintrc`;

  const eslint = {
    extends: ["react-app", "prettier", "prettier/react"],
    plugins: ["prettier"],
    rules: {},
  };

  fs.writeFileSync(filename, JSON.stringify(eslint, null, 2));
};

const prettierConfig = (options) => {
  const filename = `${options.targetDirectory}/.prettierrc`;

  const prettier = {
    overrides: [
      {
        files: ".prettierrc",
        options: {
          parser: "json",
        },
      },
      {
        files: ["public/**/*.js", "src/**/*.js", "src/**/*.jsx"],
        options: {
          trailingComma: "all",
          tabWidth: 2,
          printWidth: 100,
          semi: true,
          singleQuote: true,
          jsxBracketSameLine: true,
        },
      },
    ],
  };

  fs.writeFileSync(filename, JSON.stringify(prettier, null, 2));
};

export const configSetup = (options) => {
  const tasks = [
    {
      title: "Husky Configuration",
      task: () => huskyConfig(options),
    },
    {
      title: "Eslint Configuration",
      task: () => eslintConfig(options),
    },
    {
      title: "Prettier Configuration",
      task: () => prettierConfig(options),
    },
  ];
  return taskListGenerator("Configuration Files", tasks, true);
};
